<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title> tic tac toe </title>
<style>
  * {margin: 0; padding: 0; box-sizing: border-box;}
</style>
</head>
<body>
  <h1> Hello world </h1>
  <canvas id="canvasTag" width="800" height="500" style="border: 1px solid grey;"></canvas>
  
  
<script src="socket.io/socket.io.js"></script>
<script>
  let socket = io();
  let canvas = document.querySelector("#canvasTag");
  let ctx = canvas.getContext("2d");
  let drawing = false;
  let current = { color: 'red' };
  
  canvas.addEventListener("mousedown", (e) => {
    drawing = true;
    current.x = e.clientX;
    current.y = e.clientY;
  });
  canvas.addEventListener("mouseup", () => { drawing = false; });

  socket.on("message" , (data) => {
    console.log(data);
  });
  socket.on("drawingnew", (x0, y0, x1, y1, color) => { drawLine(x0, y0, x1, y1, color); });
  
  function drawLine(x0, y0, x1, y1, color) {
    
    console.log(x0, y0, x1, y1, color);
    ctx.beginPath();
    ctx.moveTo(x0, y0);
    ctx.lineTo(x1, y1);
    ctx.strokeStyle = color;
    ctx.lineWidth = 2;
    ctx.stroke();
    ctx.closePath();
  };
  
  canvas.addEventListener("mousemove", (e) => {
    if(drawing){
      drawLine(current.x, current.y, e.clientX, e.clientY, current.color);
      socket.emit("drawing", current.x, current.y, e.clientX, e.clientY, current.color);
      current.x = e.clientX;
      current.y = e.clientY;
    }
    
  });
</script>
</body>
</html>